<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BScheduler</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <!-- Custom CSS - YELLOW TRIAL -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style_yellow_trial.css') }}">
</head>
<body>
    <div class="wizard-container">
        <!-- Header -->
        <div class="wizard-header">
            <div class="container">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <a href="{{ url_for('landing') }}" class="brand-link" style="text-decoration:none; color:inherit; display:inline-flex; align-items:center;">
                        <h1 class="wizard-title" style="margin-bottom: 0;"><i class="bi bi-calendar-check me-2"></i><span data-i18n="app_title">BScheduler</span></h1>
                    </a>
                    <div style="display:flex; gap:12px; align-items:center;">
                        <select id="languageSelector" class="form-select" style="width: auto; min-width: 150px;">
                            <option value="en">English</option>
                            <option value="fr">Français</option>
                            <option value="vi">Tiếng Việt</option>
                            <option value="nl">Nederlands</option>
                        </select>
                        {% if session.get('user_id') %}
                        <div style="display:flex; gap:8px; align-items:center;">
                            <span class="badge bg-light text-dark" style="font-weight:600;">{{ session.username }}</span>
                            <a href="{{ url_for('logout') }}" class="btn btn-outline-secondary">Logout</a>
                        </div>
                        {% endif %}
                    </div>
                </div>
                <!-- subtitle removed as requested -->
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="container">
                <div class="progress-steps">
                    <div class="progress-step active" id="step1-indicator">
                        <div class="step-circle">
                            <i class="bi bi-clock-history"></i>
                            <span class="step-number">1</span>
                        </div>
                        <div class="step-label" data-i18n="step1_label">Time Details</div>
                    </div>
                    <div class="progress-line"></div>
                    <div class="progress-step" id="step2-indicator">
                        <div class="step-circle">
                            <i class="bi bi-people"></i>
                            <span class="step-number">2</span>
                        </div>
                        <div class="step-label" data-i18n="step2_label">Employee Details</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="container wizard-content">
            <!-- Phase 1: Time Details -->
            <div class="phase-container active" id="phase1">
                <div class="phase-card">
                    <div class="phase-header">
                        <h2 class="phase-title"><i class="bi bi-calendar3 me-2"></i><span data-i18n="step1_title">Step 1: Configure Time Settings</span></h2>
                        <p class="phase-description" data-i18n="step1_desc">Set up your working days, shifts, and scheduling requirements</p>
                    </div>

                    <form id="timeDetailsForm">
                        <!-- Working Days -->
                        <div class="config-section">
                            <div class="section-header">
                                <i class="bi bi-calendar-week"></i>
                                <h5 data-i18n="working_days">Working Days</h5>
                            </div>
                            <div class="days-selector">
                                <label class="day-checkbox-wrapper">
                                    <input type="checkbox" class="day-checkbox" id="mon" value="Mon" checked>
                                    <span class="day-label">Mon</span>
                                </label>
                                <label class="day-checkbox-wrapper">
                                    <input type="checkbox" class="day-checkbox" id="tue" value="Tue" checked>
                                    <span class="day-label">Tue</span>
                                </label>
                                <label class="day-checkbox-wrapper">
                                    <input type="checkbox" class="day-checkbox" id="wed" value="Wed" checked>
                                    <span class="day-label">Wed</span>
                                </label>
                                <label class="day-checkbox-wrapper">
                                    <input type="checkbox" class="day-checkbox" id="thu" value="Thu" checked>
                                    <span class="day-label">Thu</span>
                                </label>
                                <label class="day-checkbox-wrapper">
                                    <input type="checkbox" class="day-checkbox" id="fri" value="Fri" checked>
                                    <span class="day-label">Fri</span>
                                </label>
                                <label class="day-checkbox-wrapper">
                                    <input type="checkbox" class="day-checkbox" id="sat" value="Sat">
                                    <span class="day-label">Sat</span>
                                </label>
                                <label class="day-checkbox-wrapper">
                                    <input type="checkbox" class="day-checkbox" id="sun" value="Sun">
                                    <span class="day-label">Sun</span>
                                </label>
                            </div>
                        </div>

                        <!-- Shift Configuration -->
                        <div class="config-section">
                            <div class="section-header">
                                <i class="bi bi-clock"></i>
                                <h5 data-i18n="shift_config">Shift Configuration</h5>
                            </div>
                            <div id="shiftsContainer" class="shifts-container">
                                <!-- Default shifts -->
                                <div class="shift-row">
                                    <div class="shift-input-group">
                                        <label>Shift Name</label>
                                        <input type="text" class="form-control shift-name" value="Morning" placeholder="e.g., Morning">
                                    </div>
                                    <div class="shift-input-group">
                                        <label>Hours</label>
                                        <input type="number" class="form-control shift-hours" value="4" min="1">
                                    </div>
                                    <button type="button" class="btn btn-remove remove-shift-btn" title="Remove shift">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </div>
                                <div class="shift-row">
                                    <div class="shift-input-group">
                                        <label>Shift Name</label>
                                        <input type="text" class="form-control shift-name" value="Afternoon" placeholder="e.g., Afternoon">
                                    </div>
                                    <div class="shift-input-group">
                                        <label>Hours</label>
                                        <input type="number" class="form-control shift-hours" value="4" min="1">
                                    </div>
                                    <button type="button" class="btn btn-remove remove-shift-btn" title="Remove shift">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </div>
                                <div class="shift-row">
                                    <div class="shift-input-group">
                                        <label>Shift Name</label>
                                        <input type="text" class="form-control shift-name" value="Evening" placeholder="e.g., Evening">
                                    </div>
                                    <div class="shift-input-group">
                                        <label>Hours</label>
                                        <input type="number" class="form-control shift-hours" value="4" min="1">
                                    </div>
                                    <button type="button" class="btn btn-remove remove-shift-btn" title="Remove shift">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <button type="button" class="btn btn-add" id="addShiftBtn">
                                <i class="bi bi-plus-circle me-1"></i><span data-i18n="add_shift">Add Shift</span>
                            </button>
                        </div>

                        <!-- Staffing Requirements -->
                        <div class="config-section">
                            <div class="section-header">
                                <i class="bi bi-people-fill"></i>
                                <h5 data-i18n="staffing_req">Staffing Requirements</h5>
                            </div>
                            
                            <div class="toggle-option">
                                <input class="form-check-input" type="checkbox" id="sameMinMaxForAllShifts">
                                <label class="form-check-label" for="sameMinMaxForAllShifts">
                                    Apply same min/max to all shifts and days
                                </label>
                            </div>

                            <div class="toggle-option">
                                <input class="form-check-input" type="checkbox" id="sameMinMaxPerShiftAllDays">
                                <label class="form-check-label" for="sameMinMaxPerShiftAllDays">
                                    Apply same min/max per shift to every day
                                </label>
                            </div>

                            <div id="minMaxGlobalInput" class="global-minmax" style="display: none;">
                                <div class="minmax-inputs">
                                    <div class="input-wrapper">
                                        <label>Minimum Employees</label>
                                        <input type="number" class="form-control" id="globalMinEmp" value="1" min="0">
                                    </div>
                                    <div class="input-wrapper">
                                        <label>Maximum Employees</label>
                                        <input type="number" class="form-control" id="globalMaxEmp" value="5" min="0">
                                    </div>
                                </div>
                                <div class="toggle-option">
                                    <input class="form-check-input" type="checkbox" id="ignoreMinEmpGlobal">
                                    <label class="form-check-label" for="ignoreMinEmpGlobal">Ignore minimum constraint</label>
                                </div>
                                <div class="toggle-option">
                                    <input class="form-check-input" type="checkbox" id="ignoreMaxEmpGlobal">
                                    <label class="form-check-label" for="ignoreMaxEmpGlobal">Ignore maximum constraint</label>
                                </div>
                            </div>

                            <div id="minMaxPerShiftInput" class="global-minmax" style="display: none;">
                                <p class="text-muted mb-3">Set min/max per shift type (applies to all days):</p>
                                <div id="perShiftMinMaxContainer" class="minmax-inputs">
                                    <!-- Populated by JavaScript -->
                                </div>
                            </div>

                            <div id="minMaxIndividualInput">
                                <p class="text-muted mb-3">Set min/max employees for each shift (0 to ignore):</p>
                                <div id="minMaxGrid" class="minmax-grid">
                                    <!-- Populated by JavaScript -->
                                </div>
                            </div>
                        </div>

                        <!-- Additional Settings -->
                        <div class="config-section">
                            <div class="section-header">
                                <i class="bi bi-gear"></i>
                                <h5 data-i18n="additional_settings">Additional Settings</h5>
                            </div>
                            <div class="settings-grid">
                                <div class="setting-item">
                                    <label for="fullTimeHours">Working hours for a full-time worker (per week)</label>
                                    <input type="number" class="form-control" id="fullTimeHours" value="40" min="0">
                                    <small class="form-text">Set to 0 to ignore</small>
                                </div>
                                <div class="setting-item">
                                    <div class="toggle-option">
                                        <input class="form-check-input" type="checkbox" id="responsibleRequiredOverall">
                                        <label class="form-check-label" for="responsibleRequiredOverall">
                                            Require responsible person per shift
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="phase-actions">
                            <button type="button" class="btn btn-primary btn-next" onclick="nextPhase()">
                                <span data-i18n="continue_btn">Continue to Employee Details</span>
                                <i class="bi bi-arrow-right ms-2"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Phase 2: Employee Details -->
            <div class="phase-container" id="phase2">
                <div class="phase-card">
                    <div class="phase-header">
                        <h2 class="phase-title"><i class="bi bi-person-badge me-2"></i><span data-i18n="step2_title">Step 2: Configure Employees</span></h2>
                        <p class="phase-description" data-i18n="step2_desc">Add employees and set their availability, hours, and wages</p>
                    </div>

                    <form id="employeeDetailsForm">
                        <div class="example-data-section mb-4">
                            <div class="d-flex align-items-center gap-3">
                                <button type="button" class="btn btn-outline-primary" id="loadExampleDataBtn">
                                    <i class="bi bi-lightbulb me-1"></i>Load Example Data (20 Employees)
                                </button>
                                <span class="text-muted">Click to automatically fill with realistic sample data</span>
                            </div>
                        </div>

                        <div id="employeeSections" class="employees-container">
                            <!-- Employee sections populated by JavaScript -->
                        </div>

                        <button type="button" class="btn btn-add mb-4" id="addEmployeeBtn">
                            <i class="bi bi-person-plus me-1"></i><span data-i18n="add_employee">Add Employee</span>
                        </button>

                        <div class="phase-actions">
                            <button type="button" class="btn btn-secondary btn-prev" onclick="prevPhase()">
                                <i class="bi bi-arrow-left me-2"></i>
                                <span data-i18n="back_btn">Back to Time Details</span>
                            </button>
                            <button type="submit" class="btn btn-success btn-generate" id="submitScheduleBtn">
                                <i class="bi bi-magic me-2"></i><span data-i18n="generate_btn">Generate Schedule</span>
                            </button>
                        </div>
                    </form>

                    <!-- Loading Spinner -->
                    <div id="loadingSpinner" class="loading-overlay" style="display: none;">
                        <div class="loading-content">
                            <div class="spinner-border text-light" role="status"></div>
                            <p class="loading-text">Generating optimal schedule...</p>
                            <small>This may take up to a minute for complex scenarios</small>
                        </div>
                    </div>

                    <!-- Results Display -->
                    <div id="results" class="results-container" style="display: none;">
                        <div class="results-header">
                            <!-- Use an orange check icon for optimal result (keep consistent across themes) -->
                            <h3><i class="bi bi-check-circle-fill text-optimal me-2"></i>Optimal Schedule Generated</h3>
                        </div>
                        <div id="scheduleOutput" class="schedule-output">
                            <!-- Schedule will be injected here -->
                        </div>
                        <div class="cost-summary">
                            <p id="totalCostOutput" class="total-cost"></p>
                        </div>
                        <button type="button" class="btn btn-primary" onclick="location.reload()">
                            <i class="bi bi-arrow-clockwise me-2"></i>Create New Schedule
                        </button>
                    </div>

                    <!-- Error Display -->
                    <div id="errorDisplay" class="error-container" style="display: none;" role="alert">
                        <!-- Error messages will be injected here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/translations.js') }}"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
